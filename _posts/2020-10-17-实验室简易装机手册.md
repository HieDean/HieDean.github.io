---
layout:     post
title:      "实验室简易装机手册"
subtitle:   ""
date:       2020-10-17
author:     "HieDean"
header-img: "img/15.jpg"
tags:
    - ubuntu
---

### 制作U盘启动盘
* 首先需要在官网（https://ubuntu.com）下载ubuntu镜像并制作U盘启动盘，本文在写时ubuntu系统已更新至20.04LTS版本，但为了保证服务器稳定性，建议下载18.04LTS版或16.04LTS版。

* 制作U盘启动盘

	我所使用的软件是rufus，制作U盘启动盘的软件很多，可自行选择，这里以[rufus](https://rufus.ie/zh_CN.html)为例

	rufus界面如下：

	<img src="/img/blog/image-20201017170238717.png" alt="image-20201017170238717" style="zoom: 100%;" />

	1. `设备`一栏选择将要被制成启动盘的U盘

	2. `引导类型选择`一栏选择上一步下载的Ubuntu镜像

	3. 其余选项均默认，点击`开始`等待即可

### 使用U盘启动盘给服务器装系统

将制作好的U盘启动盘插入主板的USB-A口，启动主板并进入BIOS，不同的主板进入BIOS的方法不同，本文以实验室的大服务器，华硕主板为例。

该主板在启动时会提示如何进入BIOS，如下图所示，按`del`键即可

<img src="/img/blog/20201017171245.jpg" style="zoom: 100%;" />

进入BIOS后通过方向键选择至`boot`界面，修改硬盘启动优先级，将插入的U盘设置为最高优先级，这样主板在下次启动时才会从U盘启动，修改好之后根据提示保存并重启

重启后会进入grub引导界面，选择安装Ubuntu，即`Install Ubuntu`

<img src="/img/blog/20201017171920.jpg" style="zoom:100%;" />

这样我们就进入了ubuntu安装界面

<img src="/img/blog/20201017172313.jpg" style="zoom: 100%;" />

语言建议选择English

<img src="/img/blog/20201017172327.jpg" style="zoom:100%;" />

键盘布局建议选择English

<img src="/img/blog/20201017172336.jpg" style="zoom:100%;" />

勾选`Normal installation`和`Instal third party software...`

<img src="/img/blog/20201017172346.jpg" alt="img" style="zoom:100%;" />

勾选`something else`，进入手动分区界面

<img src="/img/blog/20201017172356.jpg" style="zoom:100%;" />



实验室的硬件配置一般都是一块SSD，一块机械硬盘，因此在手动分区界面我们可以看到两块设备分别是`/dev/sda`和`/dev/sdb`

选中SSD所对应的设备，假设是`/dev/sda`且该SSD现在未分区，点击`New Partition Table`，这样就会出现`free space`的分区space空间，当然如果SSD之前有过使用的话，可能其上已经有建好的分区了，此时可以选择备份删除或者在剩下的空闲空间进行安装

选中`free space`，点击`+`，出现下图所示窗口

<img src="/img/blog/1.jpg" alt="img" style="zoom: 100%;" />

实验室的服务器并不会被用作Web服务，大多都是用于计算，所以分区方案不需要太复杂，这里推荐一组分区方案

| parttion   |    Size     |    Type    |   Use   | Mount point |
| -------- | ---------- | ------- | --------- | ----------- |
| /        | 100G       | Primary | Ext4      | /           |
| /boot    | 1G         | Logical | Ext4      | /boot       |
| swap     | 16G        | Logical | Swap area |             |
| /home    | 剩下的空间 | Logical | Ext4      | /home       |

为了安全起见，`/home`不一定得挂载在SSD上，更好的选择是挂载在机械硬盘下并适当扩大`/`的分区大小，这样在重装系统时，只需要将SSD格式化即可，机械硬盘中的珍贵数据仍然被保留了下来

另外不建议将整块机械硬盘全部挂载为`/home`，最好分成两个分区然后只挂载其中一个，这样一个分区坏了还可以用另一个应急做备用

分区策略设置好后，点击`Device for boot loader installation`并选择SSD，这样系统便是从SSD启动的

最后点击`install now`，等待完成安装即可

除了以上步骤外，还会有设置用户名和密码的步骤，更据自己的需求设置就好

### 系统装好后的配置

新系统装好后会直接进入系统，这时需要输入用户名和密码，使用之前设置好的即可

进入系统的第一件事，由于校园网的限制，所以我们需要配置拨号上网，这里配置过程以ubuntu16.04为例

##### 配置拨号上网

<img src="/img/blog/image-20201017185706504.png" alt="image-20201017185706504" style="zoom: 100%;" />

<img src="/img/blog/image-20201017191006122.png" style="zoom:100%;" />

<img src="/img/blog/image-20201017191315346.png" alt="image-20201017191315346" style="zoom:100%;" />

<img src="/img/blog/image-20201017191612912.png" alt="image-20201017191612912" style="zoom:100%;" />

按照一以上步骤配置好后，点击`save`保存即可

然后回到桌面在右上角选择刚才创建的拨号上网选项即可

<img src="/img/blog/image-20201017192026716.png" alt="image-20201017192026716" style="zoom:100%;" />

拨号上网就配置好了

##### 下载ssh用于远程控制

打开terminal

疯狂键入以下命令

```bash
sudo apt-get update
sudo apt-get install openssh-server
sudo/etc/init.d/ssh start
```

然后查看ip

`ifconfig`

这样你就可以使用其他设备远程链接服务器了，当然前提是你的另一台设备上安装了ssh客户端（服务器上安装的是ssh服务端）

##### 安装显卡驱动

<img src="/img/blog/image-20201017193659388.png" alt="image-20201017193659388" style="zoom:100%;" />

按照上图进行即可，在`additional drivers`里选择一个需要的驱动版本即可，如果没有自己想要的驱动版本，可以在terminal中使用`sudo add-apt-repository ppa:graphics-drivers/ppa && sudo apt update`命令进行更新

如果在`apply changes`之后使用`nvidia-smi`提示显卡驱动不匹配，重启一下就好。。。

之后更据显卡驱动版本安装相应版本的cuda、cudnn，以及anaconda、pytorch等等即可，网上有很多教程，这里不再赘述